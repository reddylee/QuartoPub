---
title: "Prospective Impact of Expected Coup Outcomes on Coup Attempts: A Selection Mechanism Analysis"
author:
  - name: Zhu Qi
    affiliations: University of Essex
    email: qz21485@essex.ac.uk

date: "`r Sys.Date()`"
date-modified: last-modified
format:
  aps-html: default
  aps-pdf: default
  docx: default
  aps-revealjs:
    output-file: coups1.html
categories: [Article, Coups]
bibliography: references.bib
abstract: |
  A substantial body of research has examined coups, with much of it focusing on the factors that lead to coup attempts. However, consensus remains elusive regarding why coups are more prevalent in certain countries while less so in others. Previous scholarship exploring the determinants of coup attempts has often overlooked the crucial aspect of coup success. Given the severe consequences of a failed coup, coup plotters are unlikely to proceed unless they perceive a high chance of success. Thus, the expected outcome of a coup—whether successful or unsuccessful—is not merely incidental but serves as a pivotal determinant of coup attempts. The decision to stage a coup is a self-selected variable contingent upon the anticipated success rate of coups. This study employs a sample selection model (specifically, a two-stage probit model) to elucidate why coups are more common in some autocratic countries but rare in others. I contend that coup attempts are largely shaped by the likelihood of coup success, which, in turn, hinges on the power dynamics between coup perpetrators and incumbents. These power dynamics are influenced by the regime type and their distinct responses to internal and external shocks.
keywords: [Coup, Autocracy, Regime types, Sample selection]

execute:
  warning: false
  message: false
---

```{r}
#| label: setup
#| message: false
#| include: false
format <- knitr::opts_knit$get("rmarkdown.pandoc.to")
library(tidyverse)
library(gt)
library(gtsummary)
library(janitor)
library(scales)
library(zoo)
library(democracyData)
library(vdemdata)
library(sampleSelection)
library(stargazer)
```

```{r}
#| label: tbl-coup_year_counts
#| tbl-cap: "Coups by year and by country"
#| tbl-subcap:
#|   - "by year frequency"
#|   - "by country frequency"
#| layout-ncol: 2
#| echo: !expr format == "html"
#| include: !expr format == "html"
#load coup data
coup <- read.csv("https://www.uky.edu/~clthyn2/coup_data/powell_thyne_coups_final.txt",
                 sep = "\t")

coups <- coup |>
  summarise(
    `Coup attempted` = n(),
    `Coup succeeded` = sum(coup == 2),
    .by = country
  )

attempts <- length(coup$country)
succeeded <- length(coup$country[coup$coup == 2])

coup |> 
  summarise(counts = n(),
            .by = year) |> 
  arrange(desc(counts)) |> 
  head(15) |>
  clean_names(case = "title") |> 
  gt() |> 
  tab_options(
    table.width = pct(95),
    column_labels.font.weight = "bold") |>
  tab_source_note(source_note = md("***Source: GIC dataset***"))

coup |> 
  summarise(counts = n(),
            .by = country) |> 
  arrange(desc(counts)) |> 
  head(15) |>
  clean_names(case = "title") |> 
  gt() |> 
  cols_align(
    align = "right",
    columns = 2
  ) |>
  tab_options(
    table.width = pct(95),
    column_labels.font.weight = "bold") |>
  tab_source_note(source_note = md("***Source: GIC dataset***"))
```

## Introduction

Coups occur with varying frequency across different countries, with some
experiencing them more frequently than others. According to the Global Instances
of Coups (GIC)[^1] dataset [@powell2011], Latin American countries such as
Bolivia witnessed `r coups |> filter(country == "Bolivia") |> pull(2)` coups
between $1950$ and $1984$, while Argentina experienced
`r coups |> filter(country == "Argentina") |> pull(2)` during a similar time
frame. However, Mexico's authoritarian period from $1917$ to $2000$ saw no coups
at all. In Africa, Sudan endured
`r coups |> filter(country == "Sudan") |> pull(2)` coups between $1955$ and
$2023$, whereas South Africa has not experienced any coup since $1950$. Similar
patterns are observed in the Middle East and South Asia. The question of why
coups occur more frequently in certain regions, countries, and periods, while
being less common in others, has captivated scholars for decades. Consequently,
scholars have delved into extensive research on coups. Despite numerous efforts
in past studies to shed light on these disparities, a definitive model or set of
determinants for analysing coups remains elusive. As highlighted by
@gassebner2016, although approximately one hundred potential determinants of
coups have been suggested, the fundamental question remains unanswered.

However, despite extensive research by scholars, the impact of anticipated
outcomes on coup initiation has not received sufficient attention. When analysing
the determinants of coups, it's crucial not to overlook the most significant
characteristic of coups themselves. As noted by @powell2011, coups are "illegal
and overt attempts by the military or other elites within the state apparatus to
unseat the sitting executive."[@powell2011, P.252]. Due to their illegality, the
consequences of a failed coup could be severe, with perpetrators risking
imprisonment, exile, or even death. In some instances, the repercussions extend
to the families of the coup perpetrators.

Despite the significant risks associated with coups, as shown in @tbl-coups since
$1950$, there have still been as many as `r attempts` coups worldwide.
Furthermore, more importantly, half of these coups have been successful. At first
glance, coups seem to be a high-success-rate, high-reward political venture and
speculation. However, compared to over $12,000$ country-years since $1950$, the
occurrence of `r attempts` coups appears rather rare, accounting for less than
$4\%$ [@powell2011].

The low occurrence rate and high success rate indicate that the initiation of
coups is highly selective. In other words, the likelihood of a coup occurring
depends greatly on its potential success rate. Coup plotters carefully assess
their chances before staging a coup. If they decide to proceed, it suggests that
the conditions are relatively ripe, hence the fifty-fifty success rate. Plans
with immature conditions and low chances of success are automatically filtered
out. Fundamentally, launching a coup is not like participating in a general
election, where failure in one election allows for another attempt in the next
election. A coup is a high-stakes gamble where success brings substantial
rewards, while failure may result in martyrdom. Failure, put differently, means
permanent and absolute defeat. Furthermore, the outcomes of coups are typically
decided within a matter of days, sometimes even mere hours. Unlike prolonged
conflicts where victories or defeats may shift over time, the success of a coup
is often sealed at its inception. Every detail must be meticulously planned and
arranged beforehand.

Hence, the factors influencing the success rates of coups play a significant role
in shaping coup attempts. This study employs a sample selection model to examine
the factors affecting the success rates of coups and, consequently, the
likelihood of coup attempts. I posit that the power dynamics among coup
perpetrators, incumbents, and other ruling elites are pivotal in determining the
success of coups. These dynamics are largely contingent on regime types,
highlighting the pivotal role of regime types in shaping coup attempts.

This study offers two potential contributions to the existing literature:
firstly, it highlights the significance of power dynamics within various regime
types as critical factors influencing coup attempts; secondly, it demonstrates
how sample selection models can enhance our understanding of coup attempts by
taking into account the success rates of coups.

\clearpage

```{r}
#| label: tbl-coups
#| tbl-cap: Top 10 countries with the most coup attempts
#| echo: !expr format == "html"

coups |>
  # add one row which adds up the total
  arrange(desc(`Coup attempted`)) |>
  head(11) |> 
  add_row(
    country = "Total",
    `Coup attempted` = sum(coups[, 2]),
    `Coup succeeded` = sum(coups[, 3])
  ) |>
  mutate(Success_rate = percent(`Coup succeeded` / `Coup attempted`, 
                                accuracy = 0.1
                                )) |>   
  clean_names(case = "title") |>
  gt() |>
  tab_options(
    table.width = pct(90),
    column_labels.font.weight = "bold"
              ) |> 
  # cols_width(1 ~ px(120),
  #            2:4 ~ px(88)
  # ) |>
  cols_align(
    align = "center",
    columns = 2:3
  ) |> 
  tab_source_note(source_note = md("*Source: GIC dataset*"))
```

The subsequent section of this paper delves into previous research on coups.
Following that, in Part $3$, I present the research framework and propose
hypotheses. Part 4 provides insights into the data and variables utilized in the
study. The testing results are discussed in Part $5$, followed by the conclusion
in Part $6$.

## Dynamics of coup attempts and outcomes

When contemplating a coup, plotters grapple with two crucial factors that also
occupy coup scholars: ***disposition*** (why they take the risk) and
***capability*** (whether they can succeed).

### Disposition: Motivations for Coups

Coup motivations can be categorized into three main types:

**Personal Ambition:** The allure of absolute power, prestige, and wealth for
themselves, family, and close associates is a significant motivator.
@wintrobe2019 distinguishes between totalitarian and tinpot dictators based on
their use of power. Totalitarian leaders control every aspect of life, relishing
their authority. Tinpot leaders, however, prioritize personal enrichment,
indulging in extravagant lifestyles.

**Purported National Interest:** Sometimes, coups are justified as rescuing a
nation in crisis, upholding the constitution, or facilitating a democratic
transition. However, scepticism is warranted, as self-serving plotters often use
such rhetoric. Nevertheless, legitimate cases exist. In 2010, a coup in Niger
ousted President Tandja, who attempted an unconstitutional third term. His
actions, including dissolving the opposing Constitutional Court and calling a
self-serving referendum, triggered a coup to protect the constitution
[@ginsburg2019].

**Self-Preservation:** In rare instances, coups serve as a last resort against
imminent political persecution. Coup leaders might not seek power but fear
elimination by the incumbent leader. Consequently, the coup becomes a pre-emptive
strike rather than an ambitious power grab. An example is Idi Amin, who, in 1971,
staged a coup against Ugandan President Obote, who was attempting to remove Amin
from his position as army commander-in-chief [@sudduth2017].

While these motivations can arise in any regime, autocracies are more
susceptible, particularly for the latter two types. Stable democracies rarely
face such constitutional crises or political persecutions that necessitate coups
to protect them. However, new democracies can be vulnerable to instability,
economic downturns, and democratic backsliding which coup plotters can then use
as a pretext to justify their actions.

Despite these potential motivations, coups are relatively uncommon, occurring in
only $4\%$ of country-years since 1950. This is because even the most determined
coup plotters require the capability to succeed, which we will explore in the
next section. No rational actor attempts a guaranteed failure.

### Capability

While there may be numerous ambitious political figures vying to seize supreme
power for various reasons, only a select few have the opportunity to orchestrate
a coup. What truly determines their ability to launch a coup, however, is not
merely their willingness, but their capability. Yet, compared to the incumbent,
coup plotters naturally face disadvantages.

Firstly, as previously mentioned, coups constitute illegal actions against
incumbent leaders. To avoid the severe consequences of exposure or failure, coup
plots must remain clandestine within a tightly knit core group. Coup plotters
cannot openly recruit supporters to bolster their strength, while incumbents can
openly implement coup-proofing strategies to thwart coup attempts.

Secondly, coup plotters are uncertain about how other ruling factions might react
to their actions, particularly those capable of altering the balance of power.
Conversely, incumbent leaders possess a keen understanding of power dynamics and
take proactive measures to tilt the balance in their favour. Though unaware of
specific coup instigators, incumbent leaders are keenly aware of potential
threats and adapt accordingly to those who possess the capability to challenge
them.

Thirdly, coup plotters grapple with a loyalty dilemma and unreliable commitment
among participants. The risks involved are considerable, and anticipated benefits
are highly uncertain. Even in the event of a successful coup, there is no
guarantee that promises made by coup leaders will be honoured. Additionally,
post-coup purges often target capable assistants to pre-empt future challenges.
Consequently, defecting to support the incumbent leader seems less risky and
offers a safer bet with predictable rewards.

Given these challenges, rational coup plotters are unlikely to risk their lives
for a coup with low odds of success. Instead, they may opt to abandon their plans
or bide their time until success becomes more feasible. Therefore, when coup
perpetrators decide to take action, they must have meticulously assessed their
chances of success and deemed the risk worthwhile.

But what constitutes a 'good enough' chance of success for coup plotters to
proceed? Before delving into a theoretical framework to analyze this question,
let's first examine historical data to gain a rough idea. Surprisingly, previous
coups since 1950 suggest a rather satisfactory success rate, nearly $50\%$, as
depicted in @tbl-coups.

### Framework of coup success

An oft-cited framework [@gassebner2016a; @aidt2019] provides a structured
approach to assess the disposition and capability of coup attempts by evaluating
the anticipated benefits for coup plotters. The expected payoff of coups can be
represented by the equation:

$$
\begin{aligned}
E(U) = p \times B + (1 - p) \times (-C)
\end{aligned}
$$ {#eq-eq1}

Here, $\mathbf B$ represents the return of a successful coup, $\mathbf C$
signifies the cost of a failed coup, and $p$ represents the probability of coup
success. The condition for staging a coup is when the expected benefit is
positive, meaning that the expected pay-off is greater than 0. Rearranging the
equation, we get:

$$
\begin{aligned}
p \times B > (1 - p) \times C
\end{aligned}
$$ {#eq-eq2}

@eq-eq2 implies that for @eq-eq1 to hold, the expected benefits earned from
successful coups must outweigh the expected cost of failed coups.

While seemingly clear, the equation faces practical challenges. Quantifying
$\mathbf B$ (the value of a successful coup) and $\mathbf C$ (the cost of
failure) is difficult. The loss of life, freedom, or loved ones after a failed
coup, as well as the value of assuming leadership after a successful coup, are
intangible concepts that defy precise measurement. As evidenced by the 1979 coup
in Ghana[^2], the fate of the coup leader(s) hangs in the balance; they are high
likely to be killed if the coup fails, or to execute others if the coup succeeds.

However, these challenges do not render the framework useless. Firstly, its core
logic remains valuable, offering insights into how coup plotters might assess the
return and cost of their actions. Secondly, given the significant and elusive
nature of precise values for $\mathbf B$ and $\mathbf C$, they can be treated as
roughly equal. Consequently, there is no need to fret over how to measure and
compare these values precisely. Instead, we can shift our focus from $\mathbf B$
and $\mathbf C$, to the probability of success ($p$), simplifying @eq-eq2 to:

$$
\begin{aligned}
p > (1-p)
\end{aligned}
$$ {#eq-eq3}

@eq-eq3 suggests that, to hold @eq-eq2 true, a success probability greater than
$50\%$ is necessary. Interestingly, empirical data on coups since 1950 somewhat
supports this notion. As shown in @tbl-coups, the overall success rate is
$49.9\%$. While this falls short of the $50\%$ threshold, it's important to
consider two factors. Firstly, this is an average rate, not necessarily
reflective of the probabilities assessed by coup plotters beforehand. Secondly,
outliers such as irrational actors and coups driven by self-preservation may not
prioritize success probabilities. Taking these points into account, we can
propose our first hypothesis:

> ***H1: The primary determinant of a coup attempt is the perceived chance of
> success. Coup plotters likely require a success threshold of at least 50%.***

This leads us to the next crucial question: what factors determine a coup's
success, influencing the very decision to attempt one? While specifics may vary,
the core element hinges on the power dynamic between coup plotters and the
incumbent leaders. Logically, the more powerful entity holds a greater advantage
in this high-stakes struggle for control.

### Regime types and power dynamics

When discussing the balance of power, the first aspect that springs to mind is
military prowess. It is evident that control over the military grants individuals
the upper hand in coup attempts. This elucidates why military coups often take
center stage in coup discussions. In much of the literature on coups, the terms
"coup" and "military coup" are frequently used interchangeably, as many scholars
argue that coups are orchestrated by military personnel through the use or threat
of armed forces. @powell2011 summarise 14 studies on coups, with half of them
attributing coup attempts solely to 'the armed forces'. Consequently, most
attention, both from academic researchers and political leaders, is focused on
the balance of power between civilian and military authorities, or among military
factions. Strategies such as "Keeping the military content" [@aidt2019, P. 15] or
"providing them with resources" [@huntington1991democratization, P. 252] have
been proposed to mitigate military intervention. Many coup-proofing strategies,
informed by empirical research, aim to either decrease the military's inclination
to stage coups or erect barriers to their success. For instance, studies by
@leon2013a suggest that nations with lower military spending as a percentage of
GDP are more vulnerable to coups. Similarly, @powell2018 argue that increased
military expenditures may diminish the likelihood of coups among military
factions.

However, previous studies have often oversimplified the intricate balance of
power within military forces. They have frequently assumed that the military
operates as a monolithic entity, uniformly and decisively. Such a notion fails to
capture the complexities of real-world dynamics.

It is crucial to acknowledge that the military is not always a unified entity.
Regardless of its size, any military force is composed of various groups or
factions, each with its own chain of command. Within these factions, mutual
suspicion, competition, and vigilance are common, while moments of unity are
rare. Due to the clandestine nature of coups and the need for secrecy, coup
attempts are often orchestrated within small, tight-knit groups. Coup plotters
are uncertain about the stances and intentions of other factions beforehand, and
they are particularly worried that once the coup is initiated, other factions may
not only refuse to support it but also actively oppose, intervene in, or even
suppress it. As in the attempted coup in Niger in 2021, which occurred just two
days before the new presidential inauguration, the military unit that staged the
coup was swiftly thwarted by Niger's security forces, resulting in the failure of
the coup within an hour[^3]. Therefore, the success of a coup heavily depends on
the reactions of other military factions [@geddes1999].

More importantly, the relationship between a government and its military varies
significantly across different regime types. In democracies, civilian authority
reigns supreme. The military is considered a national institution, bound by the
constitution rather than individual leaders, whether military or civilian. For
instance, the United States Armed Forces serve under the President's command but
ultimately answer to the Constitution, ensuring they remain politically neutral.

In contrast, non-democracies present a more complex picture. The lines of
authority are often either poorly defined in written documents or blatantly
disregarded by those in actual power. Identifying the true leader of the military
hinges on the specific regime type. To explore this further, we will utilize the
foundational concepts outlined by by @geddes2014 (GWF), which categorise
autocratic regimes based on leadership origins and decision-making factors. These
regimes fall into three broad categories: military regimes, personalist regimes
(including monarchies), and dominant-party regimes. Democracies will also be
included in our analysis for comparative purposes.

**Military Regimes**

As defined by GWF, military regimes are characterized by the dominance of a junta
– a group of military officers who control the regime's power structure,
including leadership selection and policy formulation. Examples include the
Brazilian regime (1964-1985), the Argentine regime (1976-1983), and the
Salvadoran regime (1948-1984) [@geddes1999]. Notably, political parties might
still exist within military regimes, but they typically act as mouthpieces for
the junta or align themselves with the military's directives to avoid being
categorized as dominant-party regimes. Additionally, while a junta may appoint a
senior officer as the head of state or utilize civilian administrators as
intermediaries, the authority of these intermediaries over other officers remains
limited, differentiating military regimes from personalist ones.

**Personalist Regimes**

In a typical personalist regime, absolute power rests with a single dictator.
This encompasses policy making, control over the military, and the authority to
appoint top officials and successors. Personalist regimes often emerge under
charismatic leaders, particularly founding figures of newly independent nations.
Regimes like Rafael Trujillo's in the Dominican Republic (1930-1961), Idi Amin's
in Uganda (1971-1979), and Jean-Bédel Bokassa's in the Central African Republic
(1966-1979) exemplify personalist rule [@geddes1999]. In such regimes, political
parties are either absent or completely subservient to the dictator. Importantly,
the dictator may or may not have a military background, but the military itself
falls under their control.

**Dominant-Party Regimes**

In a dominant-party regime, supreme power resides within the ruling party, with
the leader acting as its representative and subject to its collective leadership.
Examples include the Partido Revolucionario Institucional (PRI) in Mexico, the
Revolutionary Party of Tanzania (CCM), and Leninist parties in various Eastern
European countries [@geddes1999]. The dominant party is a well-organized and
disciplined entity with its own ideology and political agenda used to unite and
mobilize its members and supporters. While powerful leaders may emerge within
such regimes, like Stalin in the Soviet Union (1924-1953) and Mao Zedong in China
(1949-1976), they lack the absolute power to dismantle or replace the party
altogether.

According to @geddes1999, different factions within a regime – military officers,
party cadres in dominant-party systems, and members of cliques in personalist
regimes – have distinct interests. For instance, professional soldiers prioritize
military survival and efficacy, party cadres seek to hold office, and members of
cliques depend on supporting the incumbent leader for their own survival and
relationships. While their strategies may differ, all ruling groups ultimately
prioritize self-preservation and advancement.

The key distinction between military, dominant-party, and personalist regimes
lies in the unique balance of power established by each. This power dynamic
emerges during the power seizure process. The most competent group, be it a
military junta, a political party, or a strongman, typically rises to power due
to the demanding nature of seizing control. @sudduth2017 and @roessler2011
analyse the purging of co-conspirators after power seizures, arguing that these
purges are more likely in the early stages of new regimes.

Following internal purges and external challenges, a new power dynamic emerges
among the factions within a regime, typically solidifying into one of three main
types: military regimes, personalist regimes, or dominant-party regimes.

Dominant-party regimes are the most stable due to their institutionalized
structure. A dominant party is a highly organized group with shared political
beliefs, goals, and ideologies. This shared ideology fosters internal cohesion
and a long-term vision, resulting in a robust structure with no single individual
wielding absolute power. The military force aligns with the party itself rather
than individual leaders, contributing significantly to greater regime stability
compared to personalist or military regimes. Dominant-party regimes also manage
leadership succession more effectively, as they typically regulate the process
and enforce term limits. As demonstrated by @frantz2017, 97% of country-years in
dominant-party regimes have formalized institutional succession rules, compared
to 77% in personalist regimes and a mere 59% in military regimes.

Personalist regimes also exhibit a degree of stability, as dictators usually
emerge from intense internal and external competition, with the most competent,
tough, and powerful individuals ultimately prevailing. Potential challengers have
often been purged, resulting in a relatively stable status quo within the
dictator's close circle. However, personalist regimes are vulnerable due to the
sudden death of incumbents. Rarely is there a universally accepted successor
during the chaos of power transitions, as incumbent dictators often purge
potential rivals. This uncertainty can trigger coups. Thus, while personalist
regimes maintain relative stability as long as succession is not an immediate
issue.

In contrast, military regimes are typically the least stable. These regimes often
rule through a junta, where power is shared equally among members. Mistrust and
suspicion are common, leading to frequent conflicts over benefits and policies.
Without a single authority figure, resolving these conflicts is challenging, as
no member is willing to concede, and no senior authority can enforce resolutions.
For example, General Augusto Pinochet was chosen to lead the junta in Chile after
the 1973 coup because his colleagues saw him as a safe choice due to his
professionalism, respect for rules, and uncharismatic demeanor
[@arriagadaherrera1988]. Although Pinochet later surprised them, this example
illustrates that juntas are generally unstable leadership groups.

These differing power dynamics significantly impact the likelihood of coup
attempts. Military regimes, in particular, have an inherent predisposition
towards coups, as junta members typically command their own military factions,
eliminating the need to organize an army for a coup. According to @tbl-regimes,
military regimes face the highest risk, representing only 5.6% of country-years
yet accounting for over 22% of coups. Personalist regimes follow, with 23% of
coups despite comprising only 13% of country-years. Dominant-party regimes, with
their stronger institutions and unified leadership, have the lowest incidence of
coups, constituting 22.6% of country-years but responsible for only 16.7% of
coups.

```{r}
#| label: tbl-regimes
#| tbl-cap: Regime types and coups since 1950 
#| echo: !expr format == "html"

regimes <- REIGN |>
  distinct(reign_cowcode, year, .keep_all = T) |>
  mutate(
    regime_type = case_when(
      gwf_regimetype %in% c(
        "party-based",
        "party-personal",
        "party-military",
        "party-personal-military",
        "oligarchy"
      ) ~ "dominant-party",
      gwf_regimetype == "personal" ~ "personal",
      gwf_regimetype %in% c("military", "military personal", "indirect military") ~ "military",
      gwf_regimetype == "monarchy" ~ "monarchy",
      gwf_regimetype %in% c("presidential", "parliamentary") ~ "democracy",
      TRUE ~ "other"
    )
  ) |>
  filter(year > 1949)

regime_total <- regimes |>
  tabyl(regime_type) |> 
  arrange(-n) |> 
  adorn_totals("row") |> 
  mutate(country_year =n,
         share = percent(percent),
         .keep = "unused") 
  

coup1 <- coup |>
  select(country, ccode, year, coup)

coup_by_regime <- regimes |>
  select(ccode = reign_cowcode, extended_country_name, year, regime_type) |>
  full_join(coup1, by = join_by(ccode, year)) |>
  mutate(regime = na.locf(regime_type, .by = ccode)) |>
  filter(!is.na(coup)) |>
  tabyl(regime) |> 
  adorn_totals("row") |> 
  mutate(num_of_coups = n,
         percent_of_coups = percent(percent,accuracy = 0.1),
         .keep = "unused") 

coup_by_succeed <- regimes |>
  select(ccode = reign_cowcode, extended_country_name, year, regime_type) |>
  full_join(coup1, by = join_by(ccode, year)) |>
  mutate(regime = na.locf(regime_type, .by = ccode)) |>
  filter(!is.na(coup),
         coup == 2) |>
  tabyl(regime) |> 
  adorn_totals("row") |> 
  select(regime, succeeded_coup = n) 

coup_regimes <-  coup_by_regime |> 
  left_join(coup_by_succeed) |> 
  mutate(success_rate = percent(succeeded_coup / num_of_coups, accuracy = 0.1))

regime_total |>
  left_join(coup_regimes, join_by(regime_type == regime)) |>
  mutate(regime_type = str_to_title(regime_type)) |>
  select(-succeeded_coup) |> 
  clean_names(case = "title") |>
  gt() |>
  tab_options(column_labels.font.weight = "bold",
              table.width = pct(100),
              table.align = "center") |>
  tab_source_note(source_note = md("*Source: REIGN and GIC Datasets*"))
```

> ***H2: Due to their balance of power dynamics, military regimes are more prone
> to coups, followed by personalist regimes, while dominant-party regimes are the
> least likely to experience coups among the three.***

## Research Design

### Two-stage sample selection model

To account for the determinants of coup attempts, this study utilizes a sample
selection model [@heckman1979]. While coup attempt rates vary across regimes,
success rates tend to converge around 50% (@tbl-regimes). This suggests coup
attempts are strategically planned, targeting situations with a perceived high
chance of success. Consequently, a standard regression model would yield biased
results. Therefore, we use the two-stage `probit` model, as detailed by
@vandeven1981 and utilized by @powell2012, for empirical analysis. The first
stage examines the probability that a regime experiences a coup attempt, while
the second stage evaluates the probability of the attempt's success.

The primary explanatory variables are regime types, as previously discussed.
Control variables are included in $\mathbf{XB}$. The selection equation (first
stage) models the probability that a coup attempt occurs and can be expressed as
follows:

$$
\begin{aligned}
y_1^*=\alpha_0 + \alpha_1 Regime_i + \mathbf {XA} + \mu_{1i}
\end{aligned}
$$ {#eq-eq4}

Here, ${y_1}^*$ is an unobserved variable, which may be known to coup plotters.
$Regime_i$ is a categorical variable (*military*, *personalist*, or
*dominant-party*). ***XB*** captures other control variables, such as the
economic crisis index, previous coups, military expenditure, etc.

The observed binary outcome $\mathbf{y_1}$ is:

$$
\begin{aligned}
y_1 = 
\begin{cases} 
1 &\text{if $y_1^*>0$ (coup attempt occurs)} \\
0 &\text{if $y_1^*\le0$ (no coup attempt)}
\end{cases}
\end{aligned}
$$\
In the first stage, if $y_1^*\le0$, no coup attempt occurs in a given
country-year, indicating that the unobserved variable does not reach the
threshold. If $y_1^*>0$, at least one coup attempt is made in a country-year,
indicating that the unobserved variable surpasses the threshold. The probability
is expressed as:

$$
\begin{aligned}
Prob(y_1 =1)&=Prob(y_{1}^*>0) \\
&=\Phi(\alpha_0 + \alpha_1 Regime_i + \mathbf{XA})
\end{aligned}
$$ {#eq-eq4a}

Similarly, the outcome equation (second stage) models the probability that a coup
attempt is successful, given that it occurs:

$$
\begin{aligned}
y_2^*=\beta_0 + \beta_1 Regime_i + \mathbf {XB} + \mu_{2i}
\end{aligned}
$$ {#eq-eq5}

The observed outcome $y_2$ is:

$$
\begin{aligned}
y_2 = 
\begin{cases} 
1 &\text{if $y_2^*>0$ (coup succeeds)} \\
0 &\text{if $y_2^*\le0$ (coup fails)}
\end{cases}
\end{aligned}
$$

The probability equations is:

$$
\begin{aligned}
Prob(y_2=1|y_1 =1)=\Phi(\beta_0 + \beta_1 Regime_i + \mathbf{XB})
\end{aligned}
$$ {#eq-eq5a}

In a two-stage sample selection model, the second-stage model cannot be identical
to the first-stage model. Therefore, the first-stage model includes an additional
independent variable: the tenure of the incumbent leader, which captures the
number of years since the incumbent leader assumed office. Thus, @eq-eq5a
becomes:

$$
\begin{aligned}
Prob(y_1 =1)&=Prob(y_{1}^*>0) \\
&=\Phi(\alpha_0 + \alpha_1 Regime_i + \alpha_2 Tenure_i + \mathbf{XA})
\end{aligned}
$$ {#eq-eq5b}

### Variables

#### Dependent variable

To test our hypotheses, we use coup attempts and outcomes data from @powell2011
as the dependent variable. Successful coups are those in which the incumbent is
removed from office for more than seven days. The dataset spans from 1950 to
2023, accounting for 491 coup attempts, of which 245 were successful. Descriptive
statistics are presented in @tbl-coups and @tbl-regimes.

#### Independent variables

The primary independent variable in our analysis is the regime type. We follow
the categories defined by @geddes2014 (GWF). Our main focus is on military,
personalist, and dominant-party regimes, with democracy and monarchy included as
reference categories. Descriptive statistics are presented in @tbl-regimes.

#### Control variables

**Economic performance:** We use the current-trend ($CT$) ratio developed by
@krishnarajan2019 to measure economic performance. This metric calculates the
ratio between the current level of gross domestic product per capita (GDP/cap)
and the average GDP/cap level of the previous five years. For a country $i$ at
year $t$, the $CT$ ratio is calculated as follows:

$$
CT_{i,t} = {GDP/cap_{i,t} \over {1 \over 5} {\sum_{k=1}^5GDP/cap_{i,t-k}}}
$$

Since a given year's situation is primarily determined by the previous year, the
variable is lagged by one year. The GDP per capita (in constant 2017
international dollars, PPP) is sourced from the V-Dem dataset provided by
@fariss2022.

**Violence:** The violence index captures all types of violence and wars
(internal or interstate). The data is sourced from the Major Episodes of
Political Violence [@marshall2005current].

**Military expending:** Military spending per capita measures the amount expended
per capita per year on the military. This data is sourced from the Correlates of
War Project [@sarkees2010].

## Results and Discussion

```{r}
#| label: tbl-regression
#| tbl-cap: Results of the two-stage sample selection model

political_violence <- read_excel("ps/MEPVv2018.xls") |> 
  select(ccode, year, violence = actotal)

gdp <- vdem |> 
  select(ccode = COWcode, year, gdppc = e_gdppc) |> 
  filter(year > 1944) |> 
  mutate(ct = gdppc / lag(rollapply(gdppc, width = 5, FUN = mean,
                               align = 'right', fill = NA)),
         .by = c(ccode)) 

coup_all <- read.csv("https://www.uky.edu/~clthyn2/coup_data/powell_thyne_ccode_year.txt", sep = "\t") |> 
  mutate(coup = case_when(
    coup1 == 0 ~ 0,
    coup1 == 2 | coup2 ==2 | coup3 == 2 | coup4 == 2 ~ 2,
    TRUE ~ 1
  )) |>
  select(ccode, year, coup)

reg_data <- regimes |> 
  select(country = extended_country_name,
         ccode = reign_cowcode, year, regime_type) |>
  left_join(coup_all, by = join_by(ccode, year)) |> 
  left_join(political_violence, by = join_by(ccode, year)) |>
  left_join(gdp, by = join_by(ccode, year)) |> 
  filter(!is.na(gdppc)) |> 
  mutate(violence = na.locf(violence, .by = ccode)) 

model_2step <- reg_data |>
  mutate(coup_attempt = ifelse(coup == 0, 0, 1),
         coup_succeed = case_when(coup == 2 ~ 1, 
                                  coup == 1 ~ 0,
                                  TRUE ~ NA)) |>
  filter(regime_type != "other") |>
  #view()
  selection(coup_attempt ~ regime_type + ct + violence + gdppc,
            coup_succeed ~ regime_type + ct + violence , method = "2step",
            data = _) 

stargazer(model_2step, type = "text", selection.equation = T)
stargazer(model_2step, type = "text", selection.equation = F)
  
```

```{r}
new_data <- reg_data |> 
  mutate(coup_attempt = ifelse(coup == 0, 0, 1),
         coup_succeed = case_when(coup == 2 ~ 1, 
                                  coup == 1 ~ 0,
                                  TRUE ~ NA)) |>
  filter(regime_type != "other")
probit <- new_data |> 
  mutate(coup_attempt = ifelse(coup == 0, 0, 1),
         coup_succeed = case_when(coup == 2 ~ 1, 
                                  coup == 1 ~ 0,
                                  TRUE ~ NA)) |>
  filter(regime_type != "other") |>
  glm(coup_attempt ~ regime_type + ct + violence + gdppc, family = binomial(link = "probit"), data = _) 

probit_lp <-  predict(probit)
mills0 <-  dnorm(probit_lp)/pnorm(probit_lp)

summary(mills0)

imr <- mills0[new_data$coup_attempt == 1]
summary(imr)
ggplot2::qplot(imr, geom = 'histogram')

glm(coup_succeed ~ regime_type + ct + violence  + imr, family = binomial(link = "probit"), data = new_data[new_data$coup_attempt == 1, ]) |> 
  summary()
```

## Conclusion

```{r}
#| results: asis
#| eval: !expr format == "latex"
#| echo: false
cat("\\newpage
## References")
```

[^1]: <https://www.uky.edu/~clthyn2/coup_data/home.htm>, accessed on
    `r Sys.Date()`

[^2]: In the case of the Ghanaian coup, flight lieutenant Jerry John Rawlings
    narrowly avoided execution after his initial failure, being freed by mutinous
    soldiers. Three weeks later, following Rawlings' successful overthrow of the
    government, the deposed leader, General Fred Akuffo, was executed along with
    many other senior members of his government.

[^3]: Niger: Attack on presidential palace an 'attempted coup'. Source: Al
    Jazeera. Retrieved from
    <https://www.aljazeera.com/news/2021/3/31/heavy-gunfire-heard-near-nigers-presidency.>
    Accessed on `r Sys.Date()`.
